<% render_picnums %>
<% comment do %>
  <% if @query_array %>

    <% @targets = {} %>

    <% benchmark 'get_4_before_query' do %>
      <% @items.each { |item| get_4_before_query(item.picnum) } # 此方法只針對新圖號作前四碼加強 # 1.3ms %>
    <% end %>
    <% benchmark 'assign_different_colors' do %>
      <% assign_different_colors # 0 %>
    <% end %>
    <% benchmark 'highlight_picnum_differences' do %>
      <%# if @targets.size > 1 %>
        <% @items.each do |item| %>
          <% item.picnum = highlight_picnum_differences(item.picnum) # 此方法只針對新圖號作前四碼加強 #21.5ms %>
          <% item.picnum = break_into_lines(item.picnum) # 23.6-21.5 %>
          <% item.oldpicnum = break_into_lines(item.oldpicnum) if item.oldpicnum # 23.6-21.5 %>
        <% end %>

        <%# return @items %>
      <%# end %>
    <% end %>
  <% end %>
<% end %>

<% @items.each do |item| %>

  <% submit_id = item_id_to_tag_id(item) %>
        
  <%= form_for(item, remote: true) do |f| %>

    <tr style="<%= style_customer(item.customer) %>">

      <td class="smCell center">
        <%= f.text_field :location, size: 7, id: submit_id %>
      </td>

      <td class="lgCell right">
        <%= item.picnum.html_safe %>
      </td>

      <td class="xsCell center">
        <div><!-- this div is for chrome -->
        <%= link_to edit_item_path(item) do %><span id="apple"></span><% end %>
        </div><!-- this div is for chrome -->
      </td>

      <td class="lgCell center">
        <%= item.oldpicnum.html_safe unless item.oldpicnum.nil? %>
      </td>

      <td class="lgCell center">
        <%# render_item_note(item.note) %>
        <%= f.text_area :note, :value => clear_format(item.note), rows: count_row(item.note,20), class:'item-note', id: submit_id %>
      </td>

      <td class="smCell center">
        <%= f.text_area :finished, :value => clear_format(item.finished), cols: 10, rows: count_row(item.finished,9), id: submit_id %>
      </td>

      <td class="smCell center">
        <%= f.text_area :unfinished, :value => clear_format(item.unfinished), cols: 10, rows: count_row(item.unfinished,9), id: submit_id %>
      </td>

      <td class="xsCell">
        <%= button_tag(type: 'submit', class: "no-btn hidden", id: submit_id) do %>
          <i class="fa fa-check"></i>
        <% end %>
      </td>

    </tr>

  <% end %> <!-- end of form_for -->

<% end %>